function LiveChatBackend(e){this.init=function(e){this.initParams=e;this.timeout={};this.postMessageDomain=null;this.postMessageOrigin=null;this.postMessageSource=null;this.initFrameParameters();this.initEvent()};this.initFrameParameters=function(){if(!this.isFrame()){return}if(!window.location.hash){return}var e={};try{e=JSON.parse(decodeURIComponent(window.location.hash.substring(1)))}catch(t){}if(e.domain){this.postMessageDomain=e.domain}};this.isFrame=function(){return window!=window.top};this.initEvent=function(){if(!this.isFrame()){return}if(typeof window.postMessage==="function"){BX.bind(window,"message",BX.proxy(function(e){if(e&&e.origin==this.postMessageDomain){var t={};try{t=JSON.parse(e.data)}catch(s){}if(t.action=="init"){this.uniqueLoadId=t.uniqueLoadId;this.postMessageSource=e.source;this.postMessageOrigin=e.origin;this.postMessageStartShowed=t.showed;var i={};i["uniqueLoadId"]=this.uniqueLoadId;i["action"]="init";i["title"]=this.initParams.LINE_NAME;i["connectors"]=this.initParams.CONNECTORS;i["queue"]=this.initParams.QUEUE;i["showedDialog"]=this.showedDialog?"Y":"N";if(this.initParams.ERROR_CODE){i["errorCode"]=this.initParams.ERROR_CODE}this.sendDataToFrameHolder(i);if(typeof BXIM!="undefined"){BXIM.messenger.popupMessengerTextarea.value=t.textarea;BXIM.messenger.textareaCheckText();if(this.postMessageStartShowed){setTimeout(function(){BXIM.messenger.popupMessengerTextarea.focus()},200)}}else{BX.addCustomEvent("onImInit",BX.delegate(function(e){e.messenger.popupMessengerTextarea.value=t.textarea;e.messenger.textareaCheckText();if(this.postMessageStartShowed){setTimeout(function(){e.messenger.popupMessengerTextarea.focus()},200)}},this))}}else if(t.action=="message"){BXIM.messenger.popupMessengerTextarea.value=t.text;BXIM.messenger.sendMessage(BXIM.messenger.currentTab)}else if(t.action=="textareaFocus"){setTimeout(function(){if(typeof BXIM!="undefined"){BXIM.messenger.popupMessengerTextarea.focus()}},200)}}},this))}BX.addCustomEvent("onImTextareaFocus",BX.delegate(function(e){var t={};t["uniqueLoadId"]=this.uniqueLoadId;t["action"]=e?"textareaFocused":"textareaBlured";this.sendDataToFrameHolder(t)},this));BX.addCustomEvent("onImDrawTab",BX.delegate(function(e){if(e.hasMessage){this.showedDialog=true;var t={};t["uniqueLoadId"]=this.uniqueLoadId;t["action"]="showDialog";this.sendDataToFrameHolder(t)}},this));BX.addCustomEvent("onImBeforeMessageSend",BX.delegate(function(){var e={};e["uniqueLoadId"]=this.uniqueLoadId;e["action"]="sendMessage";this.sendDataToFrameHolder(e)},this));BX.addCustomEvent("onImMessageRead",BX.delegate(function(){var e={};e["uniqueLoadId"]=this.uniqueLoadId;e["action"]="readMessage";this.sendDataToFrameHolder(e)},this));BX.addCustomEvent("onImMessageReceive",BX.delegate(function(){var e={};e["uniqueLoadId"]=this.uniqueLoadId;e["action"]="receiveMessage";this.sendDataToFrameHolder(e)},this));BX.addCustomEvent("onImResizeTextarea",BX.delegate(function(){var e={};e["uniqueLoadId"]=this.uniqueLoadId;e["action"]="resizeTextarea";this.sendDataToFrameHolder(e)},this));BX.addCustomEvent("onImOpenSmileMenu",BX.delegate(function(){var e={};e["uniqueLoadId"]=this.uniqueLoadId;e["action"]="openSmileMenu";this.sendDataToFrameHolder(e)},this))};this.sendDataToFrameHolder=function(e){var t=JSON.stringify(e);if(!this.postMessageOrigin){clearTimeout(this.timeout[t]);this.timeout[t]=setTimeout(BX.delegate(function(){this.sendDataToFrameHolder(e)},this),10);return true}if(typeof window.postMessage==="function"){if(this.postMessageSource){this.postMessageSource.postMessage(t,this.postMessageOrigin)}}var s=0;if(s){var i=window.location.hash.substring(1);top.location=i.substring(0,i.indexOf("#"))+"#"+t}};this.init(e)}
//# sourceMappingURL=script.map.js